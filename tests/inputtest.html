<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>inputtest</title>
<style>
body {background-color: white; color: black;}
.mono {font-family: monospace, "Courier New"; font-size: 11px;}
.spaces {white-space: pre-wrap;}
</style>
</head>
<body>

<table width="600">
	<col width="40%"><col width="60%">
	<tr><td>StepMismatch (min 6)</td><td><input id="inputtest" type="number" min="6" step="2" /></td></tr>
	<tr><td colspan="2"><span id="inputresult" class="mono spaces"></span></td></tr>
</table>


<script>
'use strict';
function mini(str) {
	const json = `${JSON.stringify(str)}`
	let i, len, hash = 0x811c9dc5
	for (i = 0, len = json.length; i < len; i++) {
		hash = Math.imul(31, hash) + json.charCodeAt(i) | 0
	}
	return ('0000000' + (hash >>> 0).toString(16)).slice(-8)
}

let target = document.getElementById("inputtest")
let oTests = {
	// 1st value expected valid then v
	// 3rd value expected invalid then x
	// v + x so we can check we're not falling back to the previous state
	ar: ['٤','v','٦','x'],
	en: ['4',4,'v','6',6,'x'],
	fa: ['۴','v','۶','x'],
	my: ['၄','v','၆','x'],
}
let oData = {}, aDisplay = []
for (const k of Object.keys(oTests)) {
	oData[k] = {}
	aDisplay.push("  \""+ k +"\": {")
	oTests[k].forEach(function(n) {
		target.value = n
		let value = target.value
		let charName, charValue, j
		if ("string" === typeof n) {
			charName = "charCode"; charValue = n.charCodeAt(0); j = n
		} else {
			charName = "number"; charValue = n; j = n +"_number"
		}
		let validity = target.checkValidity()
		oData[k][j] = {}
		oData[k][j][charName] = charValue
		oData[k][j]["value"] = value
		oData[k][j]["validity"] = validity
		if ("string" === typeof value) {value = "\"" + value +"\""}
		aDisplay.push("    \""+ j + "\": {\"" + charName +"\": " + charValue +", \"value\": " + value +", \"validity\": " + validity +"}")
	})
	aDisplay.push("  }")
}
document.getElementById("inputresult").innerHTML = mini(oData) +":<br>{"+ aDisplay.join("<br>") +"<br>}"

</script>
</body>
</html>

